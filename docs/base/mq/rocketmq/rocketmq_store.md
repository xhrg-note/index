# rocketmq文件存储


## 一、文件内容是什么？？？


本章节不会讲述任何与rocketmq代码有关系的东西，也不会讲高性能文件读写相关原理。纯粹讲rocketmq生成的文件有哪些，存储哪些东西，预备知识如下：

* offset是什么？

我们写文件的时候，准确的说写的都是字节byte[-128_127]，比如我在文件中写了一个整型的数字1，那么一个int数字占用四个字节，那么文件里面实际上就是写了4个byte[-128_127]数字。offset指的是偏移，比如说我写了2个int数字3和800，那么800的起始位置的偏移就是5，第五个字节开始。

* 内容存储的小办法？

比如说假设我们公司的同事姓名有2个的，也有3个的，然后我要把他们的名字写在一个文本中然后读取。那么我可以这样做"张三#李小四#王二",用#号分割。当然我也可以这么做"2张三3李小四2王二"，第一步，我读取一个数字int是2，那么往后的2位就是一个人的姓名，读完2位后，我再读一个数字是3，那么表示往后的3位又是一个人的姓名。这里我的2，3是字符数的个数，实际在使用中用字节表示。比如说第一个数字是int，那么我固定读取4个字节，一看是8，我再读8个字节转换出来就是姓名。


先搭建rocketmq单机，然后发送消息后，默认生产的文件路径是 {user.home}/store下，测试会生产文件内容如下


<img src="base/mq/rocketmq/pic/rocketmq_file.jpg" width="400"/>

如上图所示：

#### commitlog

这个是真实存消息的数据，比如说你发送了一个消息过去，你的消息内容是一些使用数据，那么这个数据就存在这里的。
commitlog下一般会有多个文件，broker写数据的时候，从第一个文件开始写，当第一个文件达到1G的时候，就写第二个文件，然后第三个第四个。一般是20个数字.
比如"00000000000000000000"，"00000000001073741824" 2个文件，可以用第二个文件的数字按照字节计算下，正好是1G。比如说我有一个消息，这个消息的offset是00000000002073741824这样一个随便的数字，那么我只要这个数字大于文件名，且小于下一个文件名，然后用这个数字减去文件名的数字，就是这个消息所在的这个文件的位置。

#### config
#### consumequeue
#### index